
{% extends 'base.html' %}

{% block content %}


<div class = "container", id="container">
<form id= "fileinput-form" action="/file" method="POST", enctype="multipart/form-data" >
  <div class="form-group col-md-4" >
    <input  class="form-control" type="file" accept=".csv,.txt" id="inputfile" name="inputfile" aria-label="file example">   
    <input class="form-control" id="hidden-input" type="hidden">
    <i class="fas fa-check-circle"></i>
    <i class="fas fa-exclamation-circle"></i>
  </div>
  <div style="margin-top:10px">
   <button class="btn btn-primary" id="submit" type="submit">Predict</button>
   <div id="eventresponse"> </div>
  </div>
</form>
</div> 

{% endblock %}


{% block script %}
<script>

$("#inputfile").bind("change",function(){
   var filesize = this.files[0].size;
   var filename = this.files[0].name;
   console.log(filesize);
   console.log(filename);

   fetch(`${window.origin}/eventtrigger`,{
   method: "POST",
   credentials: "include",
   body: JSON.stringify({filename,filesize}),
   cache: "no-cache",
   headers: new Headers({"content-type": "application/json"})   })
   .then(function(response){
       if (response.status == 200) {
       return response.json();
       }     
       })
   .then(function(data) {
       console.log(data.allowed_extension);
       $("#eventresponse").text(data.allowed_extension);
       })
   .catch((error) => console.log(error))    
});


 
</script>
{% endblock %}